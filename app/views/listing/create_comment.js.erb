<%# Called when an ajax request is made %>

<% if @comment.errors.any? %>
  $("#flash").hide(300);
  $("#new_cmt_<%= @comment.id %> comment_errors").html("<%= escape_javascript(errors_for(@comment).html_safe) %>").show(300);
<% else %>
  <%# Hide the div post_errors %>
  $("#new_cmt_<%= @comment.id %> .comment_errors").hide(300);
  <%# Update the html of the div flash_notice with the new one %>
  showFlash("<%= escape_javascript(flash[:notice])%>");

  <%# Replace the html of the div post_lists with the updated new one %>
  $("#cmt_<%= @career.id %>").html("<%= escape_javascript( render(partial: "comments", locals: { career: @career, hash: @career.comment_thread }) ) %>");

  <%# Clear the entire form %>
  <%# $("textarea.comment_body").each(function(idx, elem) { $(elem).val(''); }); %>
  for ( instance in CKEDITOR.instances ) {
    CKEDITOR.instances[instance].updateElement();
    CKEDITOR.instances[instance].setData('');
  }

  //setTimeout(function() {
    $('html, body').animate({ scrollTop: $('#cmt_<%= @comment.id %>').offset().top }, 'slow');
  //}, 3000);

<% end %>
